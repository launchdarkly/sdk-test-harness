---
name: built-in attributes - key

constants:
  IS_MATCH:
    value: true
    variationIndex: 0
    reason: { kind: "RULE_MATCH", ruleIndex: 0, ruleId: "ruleid" }
  IS_NOT_MATCH:
    value: false
    variationIndex: 1
    reason: { kind: "FALLTHROUGH" }

sdkData:
  flags:
    test-flag-for-key:
      on: true
      fallthrough: { variation: 1 }
      variations: [ true, false ]
      rules:
        - id: ruleid
          variation: 0
          clauses:
            - { attribute: key, op: in, values: [ "right-value" ] }

    test-flag-for-blank-key:
      on: true
      fallthrough: { variation: 1 }
      variations: [ true, false ]
      rules:
        - id: ruleid
          variation: 0
          clauses:
            - { attribute: key, op: in, values: [ "" ] }

evaluations:
  - name: key matches clause
    flagKey: test-flag-for-key
    user: { key: "right-value" }
    default: false
    expect: <IS_MATCH>

  - name: key does not match clause - wrong value
    flagKey: test-flag-for-key
    user: { key: "wrong-value" }
    default: false
    expect: <IS_NOT_MATCH>

  - name: key is allowed to be empty
    flagKey: test-flag-for-blank-key
    user: { key: "" }
    default: false
    expect: <IS_MATCH>
